# DevOps –ª–∞–±–∞1 - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

–î–µ–¥–ª–∞–π–Ω –±–ª–∏–∑–∫–æ... –ü–æ—Ä–∞ —á—Ç–æ-—Ç–æ –¥–µ–ª–∞—Ç—å((

---
–ò—Ç–∞–∫, —Ç—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å nginx –ø–æ –∑–∞–¥–∞–Ω–Ω–æ–º—É —Ç–∑:
- –î–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å –ø–æ https c —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–º
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ HTTP-–∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ—Ä—Ç 80) –Ω–∞ HTTPS (–ø–æ—Ä—Ç 443) –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è.
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å alias –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –ø—Å–µ–≤–¥–æ–Ω–∏–º–æ–≤ –ø—É—Ç–µ–π –∫ —Ñ–∞–π–ª–∞–º –∏–ª–∏ –∫–∞—Ç–∞–ª–æ–≥–∞–º –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
- –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ö–æ—Å—Ç—ã –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–æ–º–µ–Ω–Ω—ã—Ö –∏–º–µ–Ω –Ω–∞ –æ–¥–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ.

–í –ø—Ä–∏–Ω—Ü–∏–ø–µ, —Å—É—Ç—å –ø–æ–Ω—è—Ç–Ω–∞, –ø–æ–µ—Ö–∞–ª–∏
## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ nginx
–í—ã–ø–æ–ª–Ω—è—Ç—å –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è —è –±—É–¥—É –Ω–∞ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π VPS –Ω–∞ ubuntu, –ø–æ–¥–∫–ª—é—á–∏–≤—à–∏—Å—å —á–µ—Ä–µ–∑ `putty`.

–î–ª—è –Ω–∞—á–∞–ª–∞ —É—Å—Ç–∞–Ω–æ–≤–∏–º —Å–∞–º `nginx` –∫–æ–º–∞–Ω–¥–æ–π `apt install nginx`. 

![[Screenshot_2.png]](Screenshot_2.png)

–ò –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –¥–æ–±–∞–≤–∏–º –µ–≥–æ –≤ –∞–≤—Ç–æ–∑–∞–ø—É—Å–∫, –∞ —Ç–æ –≤–¥—Ä—É–≥ —Å–µ—Ä–≤–µ—Ä –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—Å—è. 

![[Screenshot_3.png]](Screenshot_3.png)

–£—Ä–∞, –æ–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç! –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –≤—Å—ë –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å... 

![[Screenshot_4.png]](Screenshot_4.png)
## –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Å—Ç—ã—Ö HTML-—Å—Ç—Ä–∞–Ω–∏—Ü
–†–∞–±–æ—Ç—É `nginx` –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä—è—Ç—å –Ω–∞ –∫–∞–∫–∏—Ö-—Ç–æ –ø—Ä–æ–µ–∫—Ç–∞—Ö, –ø–æ—ç—Ç–æ–º—É —Å–æ–∑–¥–∞–¥–∏–º –ø—Ä–æ—Å—Ç—ã–µ html-—Å—Ç—Ä–∞–Ω–∏—Ü—ã. 

![[Screenshot_5.png]](Screenshot_5.png)
![[Screenshot_8.png]](Screenshot_8.png)

–¢–∞–∫–∂–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∏–º –ø–æ—á–≤—É –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∞–ª–∏–∞—Å–æ–≤, –ø–æ–º–µ—Å—Ç–∏–≤ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é `shared/images`. 

![[Screenshot_7.png]](Screenshot_7.png)
## –°–æ–∑–¥–∞–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
–ï—â—ë –Ω–∞–º –Ω—É–∂–Ω–æ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `https`, –ø–æ—ç—Ç–æ–º—É –≥–µ–Ω–µ—Ä–∏–º —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã.

![[Screenshot_10.png]](Screenshot_10.png)
## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ nginx
–ù–∞–∫–æ–Ω–µ—Ü-—Ç–æ —Ç–æ, —Ä–∞–¥–∏ —á–µ–≥–æ –º—ã —Ç—É—Ç —Å–æ–±—Ä–∞–ª–∏—Å—å - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥–∞.

–ü—Ä–∏ —Ä–∞–∑–±–∏—Ä–∞—Ç–µ–ª—å—Å—Ç–≤–∞—Ö —Å –¢–ó –∏ –∫–æ–Ω—Ñ–∏–≥–æ–º —Å—Ç–∞–ª–æ –ø–æ–Ω—è—Ç–Ω–æ, —á—Ç–æ –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–∏—Ö –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–π –ø–æ–Ω–∞–¥–æ–±—è—Ç—Å—è –¥–≤–∞ –¥–æ–º–µ–Ω–∞, –∫–æ—Ç–æ—Ä—ã—Ö —É –º–µ–Ω—è –Ω–µ—Ç. –ü–æ–∫—É–ø–∞—Ç—å –¥–æ–º–µ–Ω—ã –¥–ª—è –ª–∞–±—ã –∫–∞–∫-—Ç–æ –Ω–µ —Ö–æ—á–µ—Ç—Å—è, –∞ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–µ –¥–µ–ª–∞—é—Ç—Å—è –∫—Ä–∞–π–Ω–µ –¥–æ–ª–≥–æ, –µ—Å–ª–∏ –≤–æ–æ–±—â–µ –¥–µ–ª–∞—é—Ç—Å—è. –ë—ã–ª–∏ –∏ –¥—Ä—É–≥–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã, –Ω–æ –¥–æ–∫—É–ø–∞—Ç—å –µ—â—ë –æ–¥–∏–Ω IP –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞ –Ω–µ —Ö–æ—Ç–µ–ª–æ—Å—å, —Ç–∞–∫–∂–µ –∫–∞–∫ –∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å VirtualBox –∏ –ø–æ–≤—Ç–æ—Ä—è—Ç—å —Ç–æ –∂–µ —Å–∞–º–æ–µ —Ç–∞–º. –ù–æ –∫ —Å—á–∞—Å—Ç—å—é, –º–æ–π —Ö–æ—Å—Ç–µ—Ä –≤ –∫–æ–º–ø–ª–µ–∫—Ç–µ —Å —Å–µ—Ä–≤–µ—Ä–æ–º –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç IPv6, –∫–æ—Ç–æ—Ä—ã–π –∏ –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ –¥–æ–º–µ–Ω–∞.

–û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–æ–Ω—Ñ–∏–≥ (`sudo nano /etc/nginx/sites-available/default`) –∏ –≤–ø–∏—Å—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∞ –∏–º–µ–Ω–Ω–æ: –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ `https`, –∞–ª–∏–∞—Å—ã –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏, –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤, –∏ –≤–∏—Ä—Ç—É–∞–ª—å–Ω—ã–µ —Ö–æ—Å—Ç—ã –¥–ª—è –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –¥–æ–º–µ–Ω–æ–≤ (–≤ –º–æ—ë–º —Å–ª—É—á–∞–µ IP).
```
# –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º HTTP –Ω–∞ HTTPS
server {
    listen 80;
    listen [::]:80;
    server_name 193.188.20.170 [2a0b:4140:9e90::2];

    return 301 https://$host$request_uri;
}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞
server {
    listen 443 ssl;
    listen [::]:443 ssl;
    server_name 193.188.20.170;

    ssl_certificate /root/itmo-cloud-devops-labs/lab1/cert/selfsigned.crt;
    ssl_certificate_key /root/itmo-cloud-devops-labs/lab1/cert/selfsigned.key;

    # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –¥–æ–º–µ–Ω–∞
    location / {
        root /root/itmo-cloud-devops-labs/lab1/project1;
        index index.html;
    }

    # Alias –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    location /images/ {
        alias /root/itmo-cloud-devops-labs/lab1/shared/images/;
    }
}

# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –¥–æ–º–µ–Ω–∞
server {
    listen 443 ssl;
    listen [::]:443 ssl;
    server_name [2a0b:4140:9e90::2];

    ssl_certificate /root/itmo-cloud-devops-labs/lab1/cert/selfsigned.crt;
    ssl_certificate_key /root/itmo-cloud-devops-labs/lab1/cert/selfsigned.key;

    # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä–æ–µ–∫—Ç –¥–ª—è –≤—Ç–æ—Ä–æ–≥–æ –¥–æ–º–µ–Ω–∞
    location / {
        root /root/itmo-cloud-devops-labs/lab1/project2;
        index index.html;
    }

    # Alias –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
    location /images/ {
        alias /root/itmo-cloud-devops-labs/lab1/shared/images/;
    }
}
```
–ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–Ω—Ñ–∏–≥ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –æ—à–∏–±–æ–∫ –∏ —Ä–µ—Å—Ç–∞—Ä—Ç–∏–º `nginx`

![[Screenshot_12.png]](Screenshot_12.png)

–ü–æ–ª—É—á–∞–µ–º... –ù—É –∑–∞—Ç–æ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –Ω–∞ `https` –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç!

![[Screenshot_13.png]](Screenshot_13.png)

–ê —Ä–µ—à–µ–Ω–∏–µ –æ–∫–∞–∑–∞–ª–æ—Å—å –ø—Ä–æ—Å—Ç—ã–º, `nginx` –ø—Ä–æ—Å—Ç–æ –Ω–µ –∏–º–µ–ª –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ—Å—É—Ä—Å–∞–º —Å–∞–π—Ç–æ–≤. –ú–µ–Ω—è–µ–º –≤ `nginx.conf` —é–∑–µ—Ä–∞ —Å `www-data` –Ω–∞ `root`, —Å–Ω–æ–≤–∞ —Ä–µ—Å—Ç–∞—Ä—Ç–∏–º –∏ –∫–∞–π—Ñ—É–µ–º —Å [–∫–æ—Ç](https://193.188.20.170/)–∏[–∫–æ–≤](https://[2a0b:4140:9e90::2]), –∫–æ—Ç–æ—Ä—ã—Ö —Ç–∞–∫ —Ö–æ—Ç–µ–ª–æ—Å—å —É–≤–∏–¥–µ—Ç—å –≤—Å–µ —ç—Ç–∏ ~6 —á–∞—Å–æ–≤.

![[Screenshot_14.png]](Screenshot_14.png)

![[-2147483648_-216126.jpg]](-2147483648_-216126.jpg)

*–í—Ç–æ—Ä–æ–π —Å–∫—Ä–∏–Ω —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞, —Ç–∞–∫ –∫–∞–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ IPv6 –Ω–∞ —Ä–æ—É—Ç–µ—Ä–µ –≤ –º–æ–∏ –ø–ª–∞–Ω—ã –Ω–µ –≤—Ö–æ–¥–∏–ª–∞, –∞ –º–æ–±–∏–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–Ω–µ—Ç, –∫ —Å—á–∞—Å—Ç—å—é, –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –µ–≥–æ.*

–ö–æ–Ω–µ—á–Ω–æ, –ø–æ —Ö–æ—Ä–æ—à–µ–º—É –±—ã –Ω–µ –¥–µ–ª–∞—Ç—å –Ω–∏—á–µ–≥–æ —á–µ—Ä–µ–∑ `root`, –∞ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–ª—è `www-data`, –Ω–æ, –¥—É–º–∞—é, —á—Ç–æ –≤ —É—á–µ–±–Ω—ã—Ö —Ü–µ–ª—è—Ö –º–æ–∂–Ω–æ –æ—Å—Ç–∞–≤–∏—Ç—å –∏ —Ç–∞–∫. 

–í—Å–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –¢–ó –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, —Ç–µ–ø–µ—Ä—å —Ç–æ—á–Ω–æ —É—Ä–∞!üéâ

---
–í –ø—Ä–∏–Ω—Ü–∏–ø–µ, –≤—ã–ø–æ–ª–Ω—è—Ç—å –ª–∞–±—É, —Ä–∞–∑–±–∏—Ä–∞—Ç—å—Å—è –≤ —á—ë–º-—Ç–æ –Ω–æ–≤–æ–º, –∏—Å–∫–∞—Ç—å —Ä–µ—à–µ–Ω–∏—è –æ—à–∏–±–æ–∫ –∏ –∑–∞—Ç—É–ø–æ–≤ –±—ã–ª–æ –¥–∞–∂–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ. –¢–µ–ø–µ—Ä—å —è –ø–æ–Ω–∏–º–∞—é, —á—Ç–æ —Ç–∞–∫–æ–µ `nginx` –∏ –∫–∞–∫ —Å –Ω–∏–º —Ä–∞–±–æ—Ç–∞—Ç—å. –ö —Å–æ–∂–∞–ª–µ–Ω–∏—é, —Å –¥–æ–º–µ–Ω–∞–º–∏ –ø–æ—Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∞–∫ –∏ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –Ω–æ –∑–∞—Ç–æ –ø–æ—Ç—Ä–æ–≥–∞–ª IPv6, —á—Ç–æ —Ç–æ–∂–µ –Ω–µ–ø–ª–æ—Ö–æ.

![[T0ECk.gif]](T0ECk.gif)
